<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.changji.cloud.social.mapper.ChatMessagesMapper">

    <sql id="all_columns">
        id, from_user_account, to_user_account, content, state, create_time, update_time
    </sql>
    <insert id="insertMessage">
        insert into chat_messages (from_user_account, to_user_account, content)
         values (#{chatMessages.fromUserAccount}, #{chatMessages.toUserAccount}, #{chatMessages.content})
    </insert>
    <select id="selectMessageByFromAndToAccount" resultType="com.changji.cloud.social.model.ChatMessages">
        select * from
        (select * from  chat_messages where(from_user_account = #{fromAccount} and to_user_account = #{toAccount})
        or (from_user_account = #{toAccount} and to_user_account = #{fromAccount}) order by create_time desc LIMIT #{pageSize} OFFSET #{startIndex})
        aa ORDER BY create_time
    </select>
    <select id="count" resultType="java.lang.Integer">
        select count(*) from chat_messages where(from_user_account = #{fromAccount} and to_user_account = #{toAccount})
            or (from_user_account = #{toAccount} and to_user_account = #{fromAccount})
    </select>


</mapper>
